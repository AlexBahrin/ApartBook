{% extends 'authentication/base_auth.html' %}
{% load i18n %}

{% block title %}{% trans "Sign In" %} - ApartBook{% endblock %}

{% block content %}
<div class="auth-card">
    <div class="auth-header">
        <a href="{% url 'landing' %}" class="auth-logo">
            <i class="bi bi-house-heart-fill"></i> ApartBook
        </a>
        <h1 class="auth-title">{% trans "Welcome back" %}</h1>
        <p class="auth-subtitle">{% trans "Sign in to continue to your account" %}</p>
    </div>
    
    <div class="auth-body">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{% if message.tags %}{{ message.tags }}{% else %}info{% endif %} mb-3">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        
        <form method="post">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="id_username" class="form-label">{% trans "Username" %}</label>
                <input type="text" name="username" id="id_username" class="form-control" 
                       placeholder="{% trans 'Enter your username' %}" required autofocus>
                {% if form.username.errors %}
                    <ul class="errorlist">
                        {% for error in form.username.errors %}<li>{{ error }}</li>{% endfor %}
                    </ul>
                {% endif %}
            </div>
            
            <div class="form-group">
                <div class="d-flex justify-content-between align-items-center">
                    <label for="id_password" class="form-label mb-0">{% trans "Password" %}</label>
                    <a href="{% url 'password_reset' %}" class="small text-decoration-none" style="color: var(--primary-color);">
                        {% trans "Forgot password?" %}
                    </a>
                </div>
                <div class="input-group-password mt-2">
                    <input type="password" name="password" id="id_password" class="form-control" 
                           placeholder="{% trans 'Enter your password' %}" required>
                    <button type="button" class="password-toggle" onclick="togglePassword('id_password', this)">
                        <i class="bi bi-eye"></i>
                    </button>
                </div>
                {% if form.password.errors %}
                    <ul class="errorlist">
                        {% for error in form.password.errors %}<li>{{ error }}</li>{% endfor %}
                    </ul>
                {% endif %}
            </div>
            
            {% if form.non_field_errors %}
                <div class="alert alert-danger">
                    {% for error in form.non_field_errors %}{{ error }}{% endfor %}
                </div>
            {% endif %}
            
            <div class="d-grid mt-4">
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-box-arrow-in-right me-2"></i>{% trans "Sign In" %}
                </button>
            </div>
        </form>
    </div>
    
    <div class="auth-footer">
        <p>{% trans "Don't have an account?" %} <a href="{% url 'register' %}">{% trans "Create one" %}</a></p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function togglePassword(inputId, button) {
    const input = document.getElementById(inputId);
    const icon = button.querySelector('i');
    
    if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('bi-eye');
        icon.classList.add('bi-eye-slash');
    } else {
        input.type = 'password';
        icon.classList.remove('bi-eye-slash');
        icon.classList.add('bi-eye');
    }
}
</script>
{% endblock %}